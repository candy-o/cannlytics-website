<!doctype html>
<html>
<!--
  Contact Page | Cannlytics Website
  Copyright (c) 2021 Cannlytics

  Authors: Keegan Skeate <keegan@cannlytics.com>
  Created: 1/6/2021
  Updated: 11/25/2021
  License: MIT License <https://github.com/cannlytics/cannlytics-website/blob/main/LICENSE>
  
  Optional Improvements:
    - Loading button
    - Form validation
  
  FIXME: NEED SPAM PREVENTION!
    - recaptcha
      https://cloud.google.com/recaptcha-enterprise/docs/instrument-web-pages
-->
{% extends "website/index.html" %}
{% block title %}Contact | {{ general.title }}{% endblock %}
{% load static get_env %}
{% block page_css %}
  <style>
    body.dark .captcha-question {
      color: #f8f8f8;
    }
    body.dark .textinput {
      background: transparent;
      color: #f8f8f8;
    }
  </style>
  {% comment %} <script src="https://www.google.com/recaptcha/enterprise.js?render={{ 'RECAPTCHA_SITE_KEY'|get_env }}"></script> {% endcomment %}
{% endblock %}
{% block material %}
  <div class="contact container my-4 my-lg-5 px-5">

    <!-- Hero -->
    <div class="row featurette mt-5">
      <div class="col-md-7 order-2 order-lg-1">
        <h2 class="h1 serif text-gradient-reverse pb-3 mt-3 mb-0">
          {{ contact.title }}
        </h2>
        <p class="fs-6 double-line text-dark text-start text-muted mb-4">
          {{ contact.message }}
        </p>

        <!-- Form -->
        <form
          id="contact-form"
          class="mt-4 pe-sm-5"
          action="/api/send-message/"
          method="post"
        >

          <!-- CSRF Token -->
          {% csrf_token %}
          
          <!-- Name -->
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label col-form-label-sm serif">
              Name
            </label>
            <div class="col-sm-10">
              <input
                type="text"
                id="name_input"
                class="form-control form-control-sm"
                name="name"
                spellcheck="false"
                type="text"
              >
            </div>
          </div>

          <!-- Email -->
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label col-form-label-sm serif">
              Email
            </label>
            <div class="col-sm-10">
              <input
                type="text"
                id="email_input"
                class="form-control form-control-sm"
                name="email"
                spellcheck="false"
                type="email"
              >
            </div>
          </div>

          <!-- Subject -->
          <div class="row mb-3">
            <label class="col-sm-2 col-form-label col-form-label-sm serif">
              Subject
            </label>
            <div class="col-sm-10">
              <input
                type="text"
                id="subject_input"
                class="form-control form-control-sm"
                name="subject"
                spellcheck="false"
                type="text"
              >
            </div>
          </div>

          <!-- Message -->
          <div class="form-floating mb-3">
            <textarea
              id="message_input"
              name="message"
              class="form-control form-control-sm"
              placeholder=""
              style="height:250px"
            ></textarea>
            <label for="message_input" class="serif mb-3 text-dark">
              Message
            </label>
          </div>

          <div class="d-flex align-items-center justify-content-end">
            <button
              class="btn btn-sm bg-gradient-green text-white g-recaptcha"
              data-sitekey="{{ 'RECAPTCHA_SITE_KEY'|get_env }}" 
              data-callback='onSubmit' 
              data-action='submit'
            >
              Send message
            </button>
          </div>

        </form>
      </div>

      <!-- Image -->
      <div class="col-md-5 order-1 order-lg-2 mb-3">
        <img
          src="{% static 'website/images/illustrations/cannlytics_office.svg' %}"
          width="100%"
        >
      </div>

    </div><!-- End of hero -->
  </div>
{% endblock %}

<!-- JavaScript -->
{% block page_js %}
  <script>
    function onSubmit(token) {
      document.getElementById('contact-form').submit();
    }
    // grecaptcha.enterprise.ready(function() {
    // grecaptcha.enterprise.execute('{{ 'RECAPTCHA_SITE_KEY'|get_env }}', {action: 'login'}).then(function(token) {
    //   ...
    //   });
    // });
  </script>
{% endblock %}

</html>
